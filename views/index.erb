<div class="overall-status <%= status_class(@overall_status) %>">
  <h2><%= status_text(@overall_status) %></h2>
  <p>All monitored services and their current status</p>
</div>

<% if @active_incidents.any? %>
  <div class="incident-list">
    <div style="padding: 20px 30px; border-bottom: 1px solid #e1e4e8;">
      <h2 class="section-title">Active Incidents</h2>
    </div>
    <% @active_incidents.each do |incident| %>
      <div class="incident-item">
        <div class="incident-header">
          <div>
            <div class="incident-title"><%= incident['site_name'] %></div>
            <div class="incident-details"><%= incident['error'] || 'Service disruption' %></div>
            <div class="incident-time">
              Started <%= time_ago(incident['started_at']) %>
              <% if incident['resolved_at'] %>
                &middot; Resolved <%= time_ago(incident['resolved_at']) %>
                <% if incident['duration'] %>
                  &middot; Duration: <%= format_duration(incident['duration']) %>
                <% end %>
              <% end %>
            </div>
          </div>
          <span class="incident-status <%= incident['resolved_at'] ? 'resolved' : 'active' %>">
            <%= incident['resolved_at'] ? 'Resolved' : 'Active' %>
          </span>
        </div>
      </div>
    <% end %>
  </div>
<% end %>

<div class="site-list">
  <div style="padding: 20px 30px; border-bottom: 1px solid #e1e4e8;">
    <h2 class="section-title">Services</h2>
  </div>

  <% if @summary.empty? %>
    <div class="empty-state">
      <h3>No monitoring data available</h3>
      <p>Run the site checker to start collecting data</p>
    </div>
  <% else %>
    <% @summary.each do |site_name, data| %>
      <div class="site-item">
        <div class="site-info">
          <h3><a href="/site/<%= ERB::Util.url_encode(site_name) %>"><%= site_name %></a></h3>
          <div class="url"><%= data['url'] %></div>
          <% if data['last_error'] && data['status'] == 'down' %>
            <div style="font-size: 12px; color: #dc3545; margin-top: 5px;">
              <%= data['last_error'] %>
            </div>
          <% end %>
        </div>
        <div class="site-stats">
          <div class="stat">
            <div class="stat-label">Uptime</div>
            <div class="stat-value <%= uptime_bar_class(data['uptime_percentage']) %>">
              <%= data['uptime_percentage'] %>%
            </div>
          </div>
          <% if data['avg_response_time'] %>
            <div class="stat">
              <div class="stat-label">Response Time</div>
              <div class="stat-value" style="color: #586069;">
                <%= data['avg_response_time'] %>ms
              </div>
            </div>
          <% end %>
          <div class="stat">
            <div class="stat-label">Status</div>
            <span class="status-badge status-<%= data['status'] %>">
              <%= data['status'] == 'up' ? 'Operational' : 'Down' %>
            </span>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
